<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>HYUFLIX - Character</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>

<header>
  <div class="logo" onclick="location.href='index.html'">HYUFLIX</div>
  <nav>
    <span onclick="location.href='index.html'">í™ˆ</span>
    <span onclick="location.href='shop.html'">ìƒì </span>
    <span onclick="location.href='character.html'" style="color:red;">ìºë¦­í„°</span>
    <span onclick="location.href='mypage.html'">ë§ˆì´í˜ì´ì§€</span>
  </nav>
  <div class="user-info">
    <span id="header-nickname">User</span>
    <span class="mileage-display">ğŸ’° <span id="header-mileage">0</span></span>
  </div>
</header>

<section class="character-container">
  <div class="character-preview">
    <h2>ë‚´ ìºë¦­í„°</h2>
    <div class="character-display" id="character-display">
      <div class="character-base">ğŸ§‘</div>
      <div class="character-items" id="equipped-items"></div>
    </div>
    <p class="character-name" id="character-name">Nickname</p>
  </div>
  
  <div class="inventory-panel">
    <h2>ë³´ìœ  ì•„ì´í…œ</h2>
    <div class="inventory-grid" id="inventory-grid">
      <!-- ë³´ìœ  ì•„ì´í…œ ë Œë”ë§ -->
    </div>
    
    <div class="empty-inventory" id="empty-inventory">
      <p>ğŸ˜¢ ë³´ìœ í•œ ì•„ì´í…œì´ ì—†ìŠµë‹ˆë‹¤</p>
      <button onclick="location.href='shop.html'">ìƒì  ê°€ê¸°</button>
    </div>
  </div>
</section>

<script src="game.js"></script>
<script>
  checkLogin();
  updateHeader();
  
  function renderCharacter() {
    const userData = getUserData();
    
    document.getElementById('character-name').innerText = userData.nickname;
    
    // ì¥ì°© ì¤‘ì¸ ì•„ì´í…œ í‘œì‹œ
    const equippedDiv = document.getElementById('equipped-items');
    equippedDiv.innerHTML = '';
    
    userData.equipped.forEach(item => {
      const itemDiv = document.createElement('div');
      itemDiv.className = 'equipped-item';
      itemDiv.innerHTML = item.icon;
      equippedDiv.appendChild(itemDiv);
    });
    
    // ì¸ë²¤í† ë¦¬ í‘œì‹œ
    const invGrid = document.getElementById('inventory-grid');
    const emptyMsg = document.getElementById('empty-inventory');
    
    if(userData.inventory.length === 0) {
      invGrid.style.display = 'none';
      emptyMsg.style.display = 'block';
      return;
    }
    
    invGrid.style.display = 'grid';
    emptyMsg.style.display = 'none';
    invGrid.innerHTML = '';
    
    userData.inventory.forEach(item => {
      const isEquipped = userData.equipped.some(e => e.id === item.id);
      
      const card = document.createElement('div');
      card.className = 'inventory-card';
      if(isEquipped) card.classList.add('equipped');
      
      card.innerHTML = `
        <div class="inv-icon">${item.icon}</div>
        <p class="inv-name">${item.name}</p>
        <button onclick="toggleEquip(${item.id})" class="${isEquipped ? 'unequip-btn' : 'equip-btn'}">
          ${isEquipped ? 'í•´ì œ' : 'ì°©ìš©'}
        </button>
      `;
      
      invGrid.appendChild(card);
    });
  }
  
  function toggleEquip(itemId) {
    const userData = getUserData();
    const item = userData.inventory.find(i => i.id === itemId);
    
    if(!item) return;
    
    const equippedIndex = userData.equipped.findIndex(e => e.id === itemId);
    
    if(equippedIndex !== -1) {
      // í•´ì œ
      userData.equipped.splice(equippedIndex, 1);
      alert(`${item.name}ì„(ë¥¼) í•´ì œí–ˆìŠµë‹ˆë‹¤.`);
    } else {
      // ì°©ìš©
      userData.equipped.push(item);
      alert(`${item.name}ì„(ë¥¼) ì°©ìš©í–ˆìŠµë‹ˆë‹¤!`);
    }
    
    saveUserData(userData);
    renderCharacter();
  }
  
  renderCharacter();
</script>

</body>
</html>