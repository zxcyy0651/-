<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>HYUFLIX - My Page</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>

<header>
  <div class="logo" onclick="location.href='index.html'">HYUFLIX</div>
  <nav>
    <span onclick="location.href='index.html'">í™ˆ</span>
    <span onclick="location.href='shop.html'">ìƒì </span>
    <span onclick="location.href='character.html'">ìºë¦­í„°</span>
    <span onclick="location.href='mypage.html'" style="color:red;">ë§ˆì´í˜ì´ì§€</span>
  </nav>
  <div class="user-info">
    <span id="header-nickname">User</span>
    <span class="mileage-display">ğŸ’° <span id="header-mileage">0</span></span>
  </div>
</header>

<section class="mypage-container">
  
  <!-- í”„ë¡œí•„ ì¹´ë“œ -->
  <div class="profile-card">
    <div class="profile-header">
      <div class="profile-avatar">
        <div class="avatar-base">ğŸ§‘</div>
        <div class="avatar-items" id="profile-equipped"></div>
      </div>
      <div class="profile-info">
        <h2 id="profile-nickname">Nickname</h2>
        <p class="profile-title" id="profile-title">SF íƒí—˜ê°€</p>
      </div>
    </div>
    
    <!-- ë ˆë²¨ & XP -->
    <div class="level-section">
      <div class="level-header">
        <span class="level-badge">LV <span id="user-level">1</span></span>
        <span class="xp-text"><span id="user-xp">0</span> XP</span>
      </div>
      <div class="xp-bar">
        <div class="xp-fill" id="xp-fill" style="width: 0%"></div>
      </div>
      <p class="xp-next">ë‹¤ìŒ ë ˆë²¨ê¹Œì§€: <span id="xp-needed">100</span> XP</p>
    </div>
    
    <!-- ë§ˆì¼ë¦¬ì§€ -->
    <div class="mileage-section">
      <h3>ğŸ’ ë³´ìœ  ë§ˆì¼ë¦¬ì§€</h3>
      <p class="mileage-big" id="user-mileage">0</p>
      <button onclick="location.href='shop.html'" class="shop-link-btn">ìƒì  ê°€ê¸° â†’</button>
    </div>
  </div>
  
  <!-- í†µê³„ ì¹´ë“œ -->
  <div class="stats-card">
    <h3>ğŸ“Š í™œë™ í†µê³„</h3>
    <div class="stats-grid">
      <div class="stat-item">
        <div class="stat-icon">ğŸ¬</div>
        <div class="stat-info">
          <p class="stat-value" id="stat-movies">0</p>
          <p class="stat-label">ì‹œì²­í•œ ì˜í™”</p>
        </div>
      </div>
      <div class="stat-item">
        <div class="stat-icon">â–¶ï¸</div>
        <div class="stat-info">
          <p class="stat-value" id="stat-trailers">0</p>
          <p class="stat-label">ë³¸ ì˜ˆê³ í¸</p>
        </div>
      </div>
      <div class="stat-item">
        <div class="stat-icon">â¤ï¸</div>
        <div class="stat-info">
          <p class="stat-value" id="stat-favorites">0</p>
          <p class="stat-label">ì°œí•œ ì½˜í…ì¸ </p>
        </div>
      </div>
      <div class="stat-item">
        <div class="stat-icon">ğŸ›ï¸</div>
        <div class="stat-info">
          <p class="stat-value" id="stat-items">0</p>
          <p class="stat-label">ë³´ìœ  ì•„ì´í…œ</p>
        </div>
      </div>
    </div>
  </div>
  
  <!-- ì¼ì¼ ë¯¸ì…˜ -->
  <div class="missions-card">
    <h3>ğŸ¯ ì¼ì¼ ë¯¸ì…˜</h3>
    <div class="mission-list" id="mission-list">
      <!-- ë¯¸ì…˜ë“¤ì´ ë Œë”ë§ë¨ -->
    </div>
    <p class="mission-reset">ìì •ì— ì´ˆê¸°í™”ë©ë‹ˆë‹¤</p>
  </div>
  
  <!-- ì—…ì  -->
  <div class="achievements-card">
    <h3>ğŸ† ì—…ì </h3>
    <div class="achievement-list" id="achievement-list">
      <!-- ì—…ì ë“¤ì´ ë Œë”ë§ë¨ -->
    </div>
  </div>
  
  <!-- ë¡œê·¸ì•„ì›ƒ -->
  <div class="logout-section">
    <button class="logout-btn" onclick="logout()">ë¡œê·¸ì•„ì›ƒ</button>
  </div>
  
</section>

<script src="game.js"></script>
<script>
  checkLogin();
  updateHeader();
  
  function renderMyPage() {
    const userData = getUserData();
    
    // í”„ë¡œí•„ ì •ë³´
    document.getElementById('profile-nickname').innerText = userData.nickname;
    document.getElementById('user-level').innerText = userData.level;
    document.getElementById('user-xp').innerText = userData.xp;
    document.getElementById('user-mileage').innerText = userData.mileage;
    
    // ì¹­í˜¸
    const titles = {
      1: 'SF ì‹ ì…ìƒ',
      2: 'SF íƒí—˜ê°€',
      3: 'SF ë§ˆìŠ¤í„°',
      4: 'SF ì „ë¬¸ê°€',
      5: 'SF ë ˆì „ë“œ',
      6: 'SF ì‹ '
    };
    document.getElementById('profile-title').innerText = titles[userData.level] || 'SF íŒ¬';
    
    // XP ë°”
    const nextLevelXP = [100, 300, 600, 1000, 1500, 2000][userData.level - 1] || 2000;
    const prevLevelXP = [0, 100, 300, 600, 1000, 1500][userData.level - 1] || 0;
    const currentLevelXP = userData.xp - prevLevelXP;
    const neededXP = nextLevelXP - prevLevelXP;
    const percentage = (currentLevelXP / neededXP) * 100;
    
    document.getElementById('xp-fill').style.width = percentage + '%';
    document.getElementById('xp-needed').innerText = nextLevelXP - userData.xp;
    
    // ì¥ì°© ì•„ì´í…œ
    const equippedDiv = document.getElementById('profile-equipped');
    equippedDiv.innerHTML = '';
    userData.equipped.forEach(item => {
      const itemDiv = document.createElement('div');
      itemDiv.className = 'avatar-item';
      itemDiv.innerHTML = item.icon;
      equippedDiv.appendChild(itemDiv);
    });
    
    // í†µê³„
    document.getElementById('stat-movies').innerText = userData.stats.moviesWatched;
    document.getElementById('stat-trailers').innerText = userData.stats.trailersWatched;
    document.getElementById('stat-favorites').innerText = userData.stats.favoriteCount;
    document.getElementById('stat-items').innerText = userData.inventory.length;
    
    // ì¼ì¼ ë¯¸ì…˜
    renderMissions(userData.dailyMissions);
    
    // ì—…ì 
    renderAchievements(userData.achievements);
  }
  
  function renderMissions(missions) {
    const list = document.getElementById('mission-list');
    list.innerHTML = '';
    
    const missionData = [
      { key: 'watchMovies', icon: 'ğŸ¬', name: 'ì˜í™” ì‹œì²­í•˜ê¸°' },
      { key: 'watchTrailers', icon: 'â–¶ï¸', name: 'ì˜ˆê³ í¸ ë³´ê¸°' },
      { key: 'addFavorites', icon: 'â¤ï¸', name: 'ì˜í™” ì°œí•˜ê¸°' }
    ];
    
    missionData.forEach(m => {
      const mission = missions[m.key];
      const progress = Math.min(mission.current, mission.target);
      const percentage = (progress / mission.target) * 100;
      
      const div = document.createElement('div');
      div.className = 'mission-item' + (mission.completed ? ' completed' : '');
      div.innerHTML = `
        <div class="mission-icon">${m.icon}</div>
        <div class="mission-content">
          <p class="mission-name">${m.name} ${mission.completed ? 'âœ…' : ''}</p>
          <div class="mission-progress">
            <div class="mission-bar">
              <div class="mission-fill" style="width: ${percentage}%"></div>
            </div>
            <span class="mission-count">${progress}/${mission.target}</span>
          </div>
          <p class="mission-reward">ë³´ìƒ: +${mission.reward} ğŸ’</p>
        </div>
      `;
      list.appendChild(div);
    });
  }
  
  function renderAchievements(achievements) {
    const list = document.getElementById('achievement-list');
    
    const allAchievements = [
      { id: 'first_movie', name: 'ì²« ì˜í™” ì‹œì²­', desc: 'ì²« ë²ˆì§¸ ì˜í™” ê°ìƒ', reward: 50 },
      { id: 'ten_favorites', name: 'ì˜í™” ìˆ˜ì§‘ê°€', desc: 'ì˜í™” 10ê°œ ì°œí•˜ê¸°', reward: 100 },
      { id: 'level_3', name: 'ë ˆë²¨ 3 ë‹¬ì„±', desc: 'LV3ì— ë„ë‹¬', reward: 150 },
      { id: 'level_5', name: 'ë ˆë²¨ 5 ë‹¬ì„±', desc: 'LV5ì— ë„ë‹¬', reward: 300 },
      { id: 'big_spender', name: 'ì†Œë¹„ì™•', desc: 'ìƒì ì—ì„œ 5ê°œ êµ¬ë§¤', reward: 200 }
    ];
    
    list.innerHTML = '';
    
    allAchievements.forEach(ach => {
      const unlocked = achievements.includes(ach.id);
      
      const div = document.createElement('div');
      div.className = 'achievement-item' + (unlocked ? ' unlocked' : '');
      div.innerHTML = `
        <div class="achievement-icon">${unlocked ? 'ğŸ†' : 'ğŸ”’'}</div>
        <div class="achievement-info">
          <p class="achievement-name">${ach.name}</p>
          <p class="achievement-desc">${ach.desc}</p>
          <p class="achievement-reward">+${ach.reward} ğŸ’</p>
        </div>
      `;
      list.appendChild(div);
    });
  }
  
  function logout() {
    if(confirm('ì •ë§ ë¡œê·¸ì•„ì›ƒ í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
      window.location.href = 'login.html';
    }
  }
  
  renderMyPage();
</script>

</body>
</html>
